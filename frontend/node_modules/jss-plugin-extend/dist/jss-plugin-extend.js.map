{"version":3,"file":"jss-plugin-extend.js","sources":["../../../node_modules/tiny-warning/dist/tiny-warning.esm.js","../src/index.js"],"sourcesContent":["var isProduction = process.env.NODE_ENV === 'production';\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;\n","// @flow\n/* eslint-disable no-use-before-define */\nimport warning from 'tiny-warning'\nimport type {Plugin} from 'jss'\n\nconst isObject = obj => obj && typeof obj === 'object' && !Array.isArray(obj)\nconst valueNs = `extendCurrValue${Date.now()}`\n\nfunction mergeExtend(style, rule, sheet, newStyle) {\n  const extendType = typeof style.extend\n  // Extend using a rule name.\n  if (extendType === 'string') {\n    if (!sheet) return\n    const refRule = sheet.getRule(style.extend)\n    if (!refRule) return\n    if (refRule === rule) {\n      warning(false, `[JSS] A rule tries to extend itself \\n${rule.toString()}`)\n      return\n    }\n    const {parent} = refRule.options\n    if (parent) {\n      const originalStyle = parent.rules.raw[style.extend]\n      extend(originalStyle, rule, sheet, newStyle)\n    }\n    return\n  }\n\n  // Extend using an array of objects.\n  if (Array.isArray(style.extend)) {\n    for (let index = 0; index < style.extend.length; index++) {\n      extend(style.extend[index], rule, sheet, newStyle)\n    }\n    return\n  }\n\n  // Extend is a style object.\n  for (const prop in style.extend) {\n    if (prop === 'extend') {\n      extend(style.extend.extend, rule, sheet, newStyle)\n      continue\n    }\n    if (isObject(style.extend[prop])) {\n      if (!(prop in newStyle)) newStyle[prop] = {}\n      extend(style.extend[prop], rule, sheet, newStyle[prop])\n      continue\n    }\n    newStyle[prop] = style.extend[prop]\n  }\n}\n\nfunction mergeRest(style, rule, sheet, newStyle) {\n  // Copy base style.\n  for (const prop in style) {\n    if (prop === 'extend') continue\n    if (isObject(newStyle[prop]) && isObject(style[prop])) {\n      extend(style[prop], rule, sheet, newStyle[prop])\n      continue\n    }\n\n    if (isObject(style[prop])) {\n      newStyle[prop] = extend(style[prop], rule, sheet)\n      continue\n    }\n\n    newStyle[prop] = style[prop]\n  }\n}\n\n/**\n * Recursively extend styles.\n */\nfunction extend(style, rule, sheet, newStyle = {}) {\n  mergeExtend(style, rule, sheet, newStyle)\n  mergeRest(style, rule, sheet, newStyle)\n  return newStyle\n}\n\n/**\n * Handle `extend` property.\n *\n * @param {Rule} rule\n * @api public\n */\nexport default function jssExtend(): Plugin {\n  function onProcessStyle(style, rule, sheet) {\n    if ('extend' in style) return extend(style, rule, sheet)\n    return style\n  }\n\n  function onChangeValue(value, prop, rule) {\n    if (prop !== 'extend') return value\n\n    // Value is empty, remove properties set previously.\n    if (value == null || value === false) {\n      // $FlowFixMe: Flow complains because there is no indexer property in StyleRule\n      for (const key in rule[valueNs]) {\n        rule.prop(key, null)\n      }\n      // $FlowFixMe: Flow complains because there is no indexer property in StyleRule\n      rule[valueNs] = null\n      return null\n    }\n\n    if (typeof value === 'object') {\n      // $FlowFixMe: This will be an object\n      for (const key in value) {\n        rule.prop(key, value[key])\n      }\n\n      // $FlowFixMe: Flow complains because there is no indexer property in StyleRule\n      rule[valueNs] = value\n    }\n\n    // Make sure we don't set the value in the core.\n    return null\n  }\n\n  return {onProcessStyle, onChangeValue}\n}\n"],"names":["isObject","obj","Array","isArray","valueNs","Date","now","mergeExtend","style","rule","sheet","newStyle","extendType","extend","refRule","getRule","warning","toString","parent","options","originalStyle","rules","raw","index","length","prop","mergeRest","jssExtend","onProcessStyle","onChangeValue","value","key"],"mappings":";;;;;;EACA,SAAS,OAAO,CAAC,SAAS,EAAE,OAAO,EAAE;EACrC,EAAE,AAAmB;EACrB,IAAI,IAAI,SAAS,EAAE;EACnB,MAAM,OAAO;EACb,KAAK;;EAEL,IAAI,IAAI,IAAI,GAAG,WAAW,GAAG,OAAO,CAAC;;EAErC,IAAI,IAAI,OAAO,OAAO,KAAK,WAAW,EAAE;EACxC,MAAM,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACzB,KAAK;;EAEL,IAAI,IAAI;EACR,MAAM,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC;EACxB,KAAK,CAAC,OAAO,CAAC,EAAE,EAAE;EAClB,GAAG;EACH,CAAC;;EChBD;AACA;EAGA,IAAMA,QAAQ,GAAG,SAAXA,QAAW,CAAAC,GAAG;EAAA,SAAIA,GAAG,IAAI,OAAOA,GAAP,KAAe,QAAtB,IAAkC,CAACC,KAAK,CAACC,OAAN,CAAcF,GAAd,CAAvC;EAAA,CAApB;;EACA,IAAMG,OAAO,uBAAqBC,IAAI,CAACC,GAAL,EAAlC;;EAEA,SAASC,WAAT,CAAqBC,KAArB,EAA4BC,IAA5B,EAAkCC,KAAlC,EAAyCC,QAAzC,EAAmD;EACjD,MAAMC,UAAU,GAAG,OAAOJ,KAAK,CAACK,MAAhC,CADiD;;EAGjD,MAAID,UAAU,KAAK,QAAnB,EAA6B;EAC3B,QAAI,CAACF,KAAL,EAAY;EACZ,QAAMI,OAAO,GAAGJ,KAAK,CAACK,OAAN,CAAcP,KAAK,CAACK,MAApB,CAAhB;EACA,QAAI,CAACC,OAAL,EAAc;;EACd,QAAIA,OAAO,KAAKL,IAAhB,EAAsB;EACpB,MAAAO,OAAO,CAAC,KAAD,6CAAiDP,IAAI,CAACQ,QAAL,EAAjD,CAAP;EACA;EACD;;EAP0B,QAQpBC,MARoB,GAQVJ,OAAO,CAACK,OARE,CAQpBD,MARoB;;EAS3B,QAAIA,MAAJ,EAAY;EACV,UAAME,aAAa,GAAGF,MAAM,CAACG,KAAP,CAAaC,GAAb,CAAiBd,KAAK,CAACK,MAAvB,CAAtB;EACAA,MAAAA,MAAM,CAACO,aAAD,EAAgBX,IAAhB,EAAsBC,KAAtB,EAA6BC,QAA7B,CAAN;EACD;;EACD;EACD,GAjBgD;;;EAoBjD,MAAIT,KAAK,CAACC,OAAN,CAAcK,KAAK,CAACK,MAApB,CAAJ,EAAiC;EAC/B,SAAK,IAAIU,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGf,KAAK,CAACK,MAAN,CAAaW,MAAzC,EAAiDD,KAAK,EAAtD,EAA0D;EACxDV,MAAAA,MAAM,CAACL,KAAK,CAACK,MAAN,CAAaU,KAAb,CAAD,EAAsBd,IAAtB,EAA4BC,KAA5B,EAAmCC,QAAnC,CAAN;EACD;;EACD;EACD,GAzBgD;;;EA4BjD,OAAK,IAAMc,IAAX,IAAmBjB,KAAK,CAACK,MAAzB,EAAiC;EAC/B,QAAIY,IAAI,KAAK,QAAb,EAAuB;EACrBZ,MAAAA,MAAM,CAACL,KAAK,CAACK,MAAN,CAAaA,MAAd,EAAsBJ,IAAtB,EAA4BC,KAA5B,EAAmCC,QAAnC,CAAN;EACA;EACD;;EACD,QAAIX,QAAQ,CAACQ,KAAK,CAACK,MAAN,CAAaY,IAAb,CAAD,CAAZ,EAAkC;EAChC,UAAI,EAAEA,IAAI,IAAId,QAAV,CAAJ,EAAyBA,QAAQ,CAACc,IAAD,CAAR,GAAiB,EAAjB;EACzBZ,MAAAA,MAAM,CAACL,KAAK,CAACK,MAAN,CAAaY,IAAb,CAAD,EAAqBhB,IAArB,EAA2BC,KAA3B,EAAkCC,QAAQ,CAACc,IAAD,CAA1C,CAAN;EACA;EACD;;EACDd,IAAAA,QAAQ,CAACc,IAAD,CAAR,GAAiBjB,KAAK,CAACK,MAAN,CAAaY,IAAb,CAAjB;EACD;EACF;;EAED,SAASC,SAAT,CAAmBlB,KAAnB,EAA0BC,IAA1B,EAAgCC,KAAhC,EAAuCC,QAAvC,EAAiD;EAC/C;EACA,OAAK,IAAMc,IAAX,IAAmBjB,KAAnB,EAA0B;EACxB,QAAIiB,IAAI,KAAK,QAAb,EAAuB;;EACvB,QAAIzB,QAAQ,CAACW,QAAQ,CAACc,IAAD,CAAT,CAAR,IAA4BzB,QAAQ,CAACQ,KAAK,CAACiB,IAAD,CAAN,CAAxC,EAAuD;EACrDZ,MAAAA,MAAM,CAACL,KAAK,CAACiB,IAAD,CAAN,EAAchB,IAAd,EAAoBC,KAApB,EAA2BC,QAAQ,CAACc,IAAD,CAAnC,CAAN;EACA;EACD;;EAED,QAAIzB,QAAQ,CAACQ,KAAK,CAACiB,IAAD,CAAN,CAAZ,EAA2B;EACzBd,MAAAA,QAAQ,CAACc,IAAD,CAAR,GAAiBZ,MAAM,CAACL,KAAK,CAACiB,IAAD,CAAN,EAAchB,IAAd,EAAoBC,KAApB,CAAvB;EACA;EACD;;EAEDC,IAAAA,QAAQ,CAACc,IAAD,CAAR,GAAiBjB,KAAK,CAACiB,IAAD,CAAtB;EACD;EACF;EAED;;;;;EAGA,SAASZ,MAAT,CAAgBL,KAAhB,EAAuBC,IAAvB,EAA6BC,KAA7B,EAAoCC,QAApC,EAAmD;EAAA,MAAfA,QAAe;EAAfA,IAAAA,QAAe,GAAJ,EAAI;EAAA;;EACjDJ,EAAAA,WAAW,CAACC,KAAD,EAAQC,IAAR,EAAcC,KAAd,EAAqBC,QAArB,CAAX;EACAe,EAAAA,SAAS,CAAClB,KAAD,EAAQC,IAAR,EAAcC,KAAd,EAAqBC,QAArB,CAAT;EACA,SAAOA,QAAP;EACD;EAED;;;;;;;;AAMA,EAAe,SAASgB,SAAT,GAA6B;EAC1C,WAASC,cAAT,CAAwBpB,KAAxB,EAA+BC,IAA/B,EAAqCC,KAArC,EAA4C;EAC1C,QAAI,YAAYF,KAAhB,EAAuB,OAAOK,MAAM,CAACL,KAAD,EAAQC,IAAR,EAAcC,KAAd,CAAb;EACvB,WAAOF,KAAP;EACD;;EAED,WAASqB,aAAT,CAAuBC,KAAvB,EAA8BL,IAA9B,EAAoChB,IAApC,EAA0C;EACxC,QAAIgB,IAAI,KAAK,QAAb,EAAuB,OAAOK,KAAP,CADiB;;EAIxC,QAAIA,KAAK,IAAI,IAAT,IAAiBA,KAAK,KAAK,KAA/B,EAAsC;EACpC;EACA,WAAK,IAAMC,GAAX,IAAkBtB,IAAI,CAACL,OAAD,CAAtB,EAAiC;EAC/BK,QAAAA,IAAI,CAACgB,IAAL,CAAUM,GAAV,EAAe,IAAf;EACD,OAJmC;;;EAMpCtB,MAAAA,IAAI,CAACL,OAAD,CAAJ,GAAgB,IAAhB;EACA,aAAO,IAAP;EACD;;EAED,QAAI,OAAO0B,KAAP,KAAiB,QAArB,EAA+B;EAC7B;EACA,WAAK,IAAMC,IAAX,IAAkBD,KAAlB,EAAyB;EACvBrB,QAAAA,IAAI,CAACgB,IAAL,CAAUM,IAAV,EAAeD,KAAK,CAACC,IAAD,CAApB;EACD,OAJ4B;;;EAO7BtB,MAAAA,IAAI,CAACL,OAAD,CAAJ,GAAgB0B,KAAhB;EACD,KAtBuC;;;EAyBxC,WAAO,IAAP;EACD;;EAED,SAAO;EAACF,IAAAA,cAAc,EAAdA,cAAD;EAAiBC,IAAAA,aAAa,EAAbA;EAAjB,GAAP;EACD;;;;;;;;;;;;"}