{"version":3,"file":"jss-plugin-rule-value-observable.js","sources":["../../../node_modules/symbol-observable/es/ponyfill.js","../../../node_modules/symbol-observable/es/index.js","../src/index.js"],"sourcesContent":["export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","/* @flow */\nimport $$observable from 'symbol-observable'\nimport {\n  createRule,\n  type StyleRule,\n  type Rule,\n  type RuleOptions,\n  type JssStyle,\n  type UpdateOptions\n} from 'jss'\nimport type {Observable} from './types'\n\nconst isObservable = value => value && value[$$observable] && value === value[$$observable]()\n\nexport type Options = UpdateOptions\n\nexport default function observablePlugin(updateOptions?: Options) {\n  return {\n    onCreateRule(name?: string, decl: JssStyle, options: RuleOptions): Rule | null {\n      if (!isObservable(decl)) return null\n\n      // Cast `decl` to `Observable`, since it passed the type guard.\n      const style$ = (decl: Observable<{[string]: string | number}>)\n\n      const rule = ((createRule(name, {}, options): any): StyleRule)\n\n      // TODO\n      // Call `stream.subscribe()` returns a subscription, which should be explicitly\n      // unsubscribed from when we know this sheet is no longer needed.\n      style$.subscribe((style: JssStyle) => {\n        for (const prop in style) {\n          rule.prop(prop, style[prop], updateOptions)\n        }\n      })\n\n      return rule\n    },\n\n    onProcessRule(rule: Rule) {\n      if (rule && rule.type !== 'style') return\n\n      const styleRule = ((rule: any): StyleRule)\n      const {style} = styleRule\n      for (const prop in style) {\n        const value = style[prop]\n        if (!isObservable(value)) continue\n        delete style[prop]\n        value.subscribe({\n          next: nextValue => {\n            styleRule.prop(prop, nextValue, updateOptions)\n          }\n        })\n      }\n    }\n  }\n}\n"],"names":["ponyfill","isObservable","value","$$observable","observablePlugin","updateOptions","onCreateRule","name","decl","options","style$","rule","createRule","subscribe","style","prop","onProcessRule","type","styleRule","next","nextValue"],"mappings":";;;;;;CAAe,SAAS,wBAAwB,CAAC,IAAI,EAAE;CACvD,CAAC,IAAI,MAAM,CAAC;CACZ,CAAC,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;;CAE1B,CAAC,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE;CACnC,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE;CACzB,GAAG,MAAM,GAAG,MAAM,CAAC,UAAU,CAAC;CAC9B,GAAG,MAAM;CACT,GAAG,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC;CACjC,GAAG,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC;CAC9B,GAAG;CACH,EAAE,MAAM;CACR,EAAE,MAAM,GAAG,cAAc,CAAC;CAC1B,EAAE;;CAEF,CAAC,OAAO,MAAM,CAAC;CACf,CAAC;;CChBD;AACA,AACA;CACA,IAAI,IAAI,CAAC;;CAET,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;CACjC,EAAE,IAAI,GAAG,IAAI,CAAC;CACd,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;CAC1C,EAAE,IAAI,GAAG,MAAM,CAAC;CAChB,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;CAC1C,EAAE,IAAI,GAAG,MAAM,CAAC;CAChB,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;CAC1C,EAAE,IAAI,GAAG,MAAM,CAAC;CAChB,CAAC,MAAM;CACP,EAAE,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,EAAE,CAAC;CACnC,CAAC;;CAED,IAAI,MAAM,GAAGA,wBAAQ,CAAC,IAAI,CAAC,CAAC;;CCL5B,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAC,KAAK;CAAA,SAAIA,KAAK,IAAIA,KAAK,CAACC,MAAD,CAAd,IAAgCD,KAAK,KAAKA,KAAK,CAACC,MAAD,CAAL,EAA9C;CAAA,CAA1B;;AAIA,CAAe,SAASC,gBAAT,CAA0BC,aAA1B,EAAmD;CAChE,SAAO;CACLC,IAAAA,YADK,wBACQC,IADR,EACuBC,IADvB,EACuCC,OADvC,EAC0E;CAC7E,UAAI,CAACR,YAAY,CAACO,IAAD,CAAjB,EAAyB,OAAO,IAAP,CADoD;;CAI7E,UAAME,MAAM,GAAIF,IAAhB;CAEA,UAAMG,IAAI,GAAKC,cAAU,CAACL,IAAD,EAAO,EAAP,EAAWE,OAAX,CAAzB,CAN6E;CAS7E;CACA;;CACAC,MAAAA,MAAM,CAACG,SAAP,CAAiB,UAACC,KAAD,EAAqB;CACpC,aAAK,IAAMC,IAAX,IAAmBD,KAAnB,EAA0B;CACxBH,UAAAA,IAAI,CAACI,IAAL,CAAUA,IAAV,EAAgBD,KAAK,CAACC,IAAD,CAArB,EAA6BV,aAA7B;CACD;CACF,OAJD;CAMA,aAAOM,IAAP;CACD,KAnBI;CAqBLK,IAAAA,aArBK,yBAqBSL,IArBT,EAqBqB;CACxB,UAAIA,IAAI,IAAIA,IAAI,CAACM,IAAL,KAAc,OAA1B,EAAmC;CAEnC,UAAMC,SAAS,GAAKP,IAApB;CAHwB,UAIjBG,KAJiB,GAIRI,SAJQ,CAIjBJ,KAJiB;;CAAA,iCAKbC,IALa;CAMtB,YAAMb,KAAK,GAAGY,KAAK,CAACC,IAAD,CAAnB;CACA,YAAI,CAACd,YAAY,CAACC,KAAD,CAAjB,EAA0B;CAC1B,eAAOY,KAAK,CAACC,IAAD,CAAZ;CACAb,QAAAA,KAAK,CAACW,SAAN,CAAgB;CACdM,UAAAA,IAAI,EAAE,cAAAC,SAAS,EAAI;CACjBF,YAAAA,SAAS,CAACH,IAAV,CAAeA,IAAf,EAAqBK,SAArB,EAAgCf,aAAhC;CACD;CAHa,SAAhB;CATsB;;CAKxB,WAAK,IAAMU,IAAX,IAAmBD,KAAnB,EAA0B;CAAA,yBAAfC,IAAe;;CAAA,iCAEE;CAO3B;CACF;CApCI,GAAP;CAsCD;;;;;;;;;;;;"}